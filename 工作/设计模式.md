# 设计模式

### 一、状态模式

#### 定义

状态即事物所处的某一种形态。状态模式是说一个对象在其内部状态发生改变时，其表现的行为和外在属性不一样。

![](https://cdn.jsdelivr.net/gh/Zypher0/Notebook/海颐/image/2021-08-30_16-42-15.png)  



#### 说明

1、状态可能十分复杂，通常会将所有状态相关的属性抽取成一个状态类

2、状态应该是单例的

#### 应用场景

1、一个对象的行为取决于它的状态，并且它在运行时可能经常改变它的状态从而改变它的行为

2、一个操作中含有庞大的多分支条件语句，且这些分支依赖于该对象的状态，且每一个分支的业务逻辑非常复杂时，可以使用状态模式来拆分这些分支逻辑，是程序有更好的可读性可维护性



### 二、装饰器模式

#### 特点

主要两个角色：装饰器和被装饰的对象

装饰器和被装饰的对象：实现了同一个接口，装饰器中使用了被装饰的对象

#### 作用

动态的给一个对象增加一些额外的功能，比使用子类更加灵活

![](https://cdn.jsdelivr.net/gh/Zypher0/Notebook/海颐/image/2021-08-30_16-41-28.png)  

#### 优缺点

**优点：**

1. 可以让两个没有关联的类一起使用装饰器模式来实现扩展，比继承更加灵活，可以在不创建更多子类的情况下，将对象的功能加以扩展
2. 可以动态的给一个对象附加更多的功能
3. 可以用不同的装饰器进行多重装饰，装饰的顺序不同，可能产生不同的效果
4. 装饰器和被装饰器类可以独立发展，不会相互耦合；装饰器模式相当于是继承的一个替代模式

**缺点：**

1. 与继承相比，用装饰的方式扩展功能更加容易出错，排错也更加困难
2. 对于多次装饰的对象，调试时寻找错误可能需要逐级排查，比较繁琐

#### 典型应用

IO流中的缓冲流等



### 三、模板模式

#### 定义

在一个方法中定义一个算法的骨架，将一些步骤延迟到子类中。这可以使得子类在不改变算法结构的情况下，重新定义算法中的某些步骤

![](https://cdn.jsdelivr.net/gh/Zypher0/Notebook/海颐/image/2021-08-30_15-55-52.png) 

#### 应用

前置钩子、后置钩子

#### 优缺点

**优点**

1. 封装不变公共代码，便于维护
2. 可变部分的代码由子类自由决定，扩展性强

**缺点**

1. 每增加一个不同的实现都需要增加一个子类，可能导致类数量变多，增加系统复杂性

### 四、职责模式(责任链模式)

#### 定义

避免请求发送者和接受者耦合在一起，让多个对象都有可能接受请求，将这些对象连接成一条链，并且沿着这条链传递请求，直到有对象处理它为止

![](https://cdn.jsdelivr.net/gh/Zypher0/Notebook/海颐/image/2021-09-01_11-03-17.png)  

#### 应用

责任链模式常用于过滤器、拦截器、事件(鼠标键盘事件、冒泡事件)等场景

#### 优缺点

**优点**

1. 请求者与接受者解耦
2. 可以动态的增加或减少责任链上的对象，或者修改顺序

**缺点**

1. 调用者不知道请求可能被哪些责任链对象处理，不利于拍错
2. 用户请求可能被责任链中途拦截，最终未被真正执行



### 五、代理模式

#### 定义

代理模式为另一个对象提供一个替身或者占位符以控制对这个对象的访问。给某一个对象提供一个代理，并由代理对象控制对原对象的引用

![](https://cdn.jsdelivr.net/gh/Zypher0/Notebook/海颐/image/2021-09-01_11-59-18.png) 

#### 关键

**主题(Subject)**：定义 “操作/活动/任务” 的接口类

**真实主题(Real Subject)**：真正完成 “操作/活动/任务” 的具体类

**代理主题(Proxy Subject)**：代替真实主题完成 “操作/活动/任务” 的代理类

#### 应用场景

1. 不想或者不能直接引用一个对象时
2. 想对一个对象的功能进行增强时
3. 各种特殊用途的代理 (远程代理、虚拟代理、防火墙代理等)

#### 优缺点

**优点**

1. 能够协调调用者和被调用者，在一定程度上降低了系统的耦合度
2. 可以灵活地隐藏被代理对象的部分功能和服务，也可以额外增加功能和服务

**缺点**

1. 由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢
2. 实现代理模式需要额外的工作，有些代理模式的实现可能非常复杂

















